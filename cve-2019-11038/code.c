#include <stdio.h>
#include <stdlib.h>

char *user_input() {
  char *buf = malloc(100);
  printf("Enter input\n");
  scanf("%99s", buf);
  return buf;
}

void spam_stack() {
  char buf[100];
  register int i;
  for (i = 0; i < 100; i++) {
    buf[i] = 'a';
  }
  printf("Stack spammed: %s\n", buf);
}

void vuln() {
  unsigned int hex;
  unsigned int hex2;
  char *input, *input2;

  input = user_input();
  if (sscanf(input, "%x", &hex) == 1) {
    printf("Hex: %x\n", hex);
  }

  input2 = user_input();
  sscanf(input2, "%x", &hex2); // VULN
  printf("Hex2: %x\n", hex2);

  free(input);
  free(input2);
}

int main() {
  spam_stack();
  vuln();

  return 0;
}